<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Halal Store - ŸÖÿ™ÿ¨ÿ± ÿ≠ŸÑÿßŸÑ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .animate-spin { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .slide-container { position: relative; overflow: hidden; }
        .slide { transition: transform 0.7s ease-in-out; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="max-w-md mx-auto bg-white shadow-2xl min-h-screen"></div>

    <script>
        // API Configuration
        const API_URL = 'https://alal-store.onrender.com/api';
        
        // State
        let products = [];
        let cart = [];
        let currentPage = 'home';
        let currentSlide = 0;
        
        // Slides
        const slides = [
            {
                title: 'Fresh Halal Meats',
                subtitle: 'Premium Quality',
                image: 'https://images.unsplash.com/photo-1588168333986-5078d3ae3976?w=800&h=400&fit=crop',
                discount: '30% OFF'
            },
            {
                title: 'Best Prices',
                subtitle: 'Save More',
                image: 'https://images.unsplash.com/photo-1603048588665-791ca8aea617?w=800&h=400&fit=crop',
                discount: '25% OFF'
            }
        ];
        
        // Fetch Products
        async function fetchProducts() {
            try {
                const response = await fetch(`${API_URL}/products`);
                const data = await response.json();
                products = data.products || [];
            } catch (error) {
                console.error('Error:', error);
                // Fallback products
                products = [
                    {
                        id: 1,
                        name: 'Best Beef Steak',
                        price: 150,
                        oldPrice: 200,
                        rating: 4.6,
                        image: 'https://images.unsplash.com/photo-1588168333986-5078d3ae3976?w=400',
                        category: 'beef',
                        badge: 'BEST'
                    },
                    {
                        id: 2,
                        name: 'Chicken Premium',
                        price: 170,
                        oldPrice: 220,
                        rating: 4.5,
                        image: 'https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=400',
                        category: 'chicken',
                        badge: 'NEW'
                    }
                ];
            }
            render();
        }
        
        // Add to Cart
        function addToCart(product) {
            const existing = cart.find(item => item.id === product.id);
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            render();
            alert('‚úÖ ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑŸÑÿ≥ŸÑÿ©!');
        }
        
        // Navigate
        function navigate(page) {
            currentPage = page;
            render();
        }
        
        // Render
        function render() {
            const app = document.getElementById('app');
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (currentPage === 'home') {
                app.innerHTML = `
                    <!-- Header -->
                    <div class="bg-white rounded-b-3xl shadow-lg p-6 sticky top-0 z-20">
                        <div class="text-center mb-4">
                            <h1 class="text-2xl font-bold text-gray-800">üïå Halal Store</h1>
                            <p class="text-sm text-gray-500">New York, USA</p>
                        </div>
                        <div class="relative">
                            <input type="text" placeholder="Search products..." 
                                class="w-full px-12 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 outline-none">
                            <i class="fas fa-search absolute left-4 top-4 text-gray-400"></i>
                        </div>
                    </div>
                    
                    <!-- Slider -->
                    <div class="px-6 mt-6">
                        <div class="relative rounded-2xl overflow-hidden shadow-xl h-64">
                            <img src="${slides[currentSlide].image}" class="w-full h-full object-cover">
                            <div class="absolute inset-0 bg-gradient-to-r from-black/70 to-transparent flex items-center">
                                <div class="text-white px-6">
                                    <span class="inline-block bg-red-600 px-3 py-1 rounded-full text-xs font-bold mb-2">
                                        ${slides[currentSlide].discount}
                                    </span>
                                    <h2 class="text-2xl font-bold mb-1">${slides[currentSlide].title}</h2>
                                    <p class="text-sm mb-3">${slides[currentSlide].subtitle}</p>
                                    <button class="bg-emerald-600 px-5 py-2 rounded-xl font-bold text-sm">
                                        Shop Now ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Products -->
                    <div class="px-6 mt-8 pb-24">
                        <h3 class="text-lg font-bold mb-4">ŸÖŸÜÿ™ÿ¨ÿßÿ™ŸÜÿß</h3>
                        <div class="grid grid-cols-2 gap-4">
                            ${products.map(product => `
                                <div class="bg-white rounded-2xl overflow-hidden shadow-md">
                                    <div class="relative h-36">
                                        <img src="${product.image}" class="w-full h-full object-cover">
                                        ${product.badge ? `
                                            <div class="absolute top-2 left-2 bg-orange-500 text-white px-2 py-1 rounded-lg text-xs font-bold">
                                                ${product.badge}
                                            </div>
                                        ` : ''}
                                        <div class="absolute bottom-2 left-2 flex items-center gap-1 bg-white px-2 py-1 rounded-lg">
                                            <i class="fas fa-star text-yellow-400 text-xs"></i>
                                            <span class="text-xs font-bold">${product.rating}</span>
                                        </div>
                                    </div>
                                    <div class="p-3">
                                        <p class="text-sm font-bold text-gray-800 mb-2 truncate">${product.name}</p>
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <span class="text-emerald-700 font-bold">${product.price} CAD</span>
                                                ${product.oldPrice ? `
                                                    <span class="text-gray-400 text-xs line-through ml-1">${product.oldPrice}</span>
                                                ` : ''}
                                            </div>
                                            <button onclick="addToCart(${JSON.stringify(product).replace(/"/g, '&quot;')})" 
                                                class="w-8 h-8 bg-emerald-700 rounded-full flex items-center justify-center text-white">
                                                <i class="fas fa-plus text-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (currentPage === 'cart') {
                app.innerHTML = `
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <button onclick="navigate('home')" class="w-10 h-10 bg-white rounded-xl flex items-center justify-center shadow">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <h1 class="text-2xl font-bold">ÿßŸÑÿ≥ŸÑÿ©</h1>
                            <div class="w-10"></div>
                        </div>
                        
                        ${cart.length === 0 ? `
                            <div class="text-center py-20">
                                <i class="fas fa-shopping-cart text-gray-300 text-6xl mb-4"></i>
                                <p class="text-xl font-bold mb-2">ÿßŸÑÿ≥ŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©</p>
                                <button onclick="navigate('home')" class="mt-4 bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold">
                                    ÿßÿ®ÿØÿ£ ÿßŸÑÿ™ÿ≥ŸàŸÇ
                                </button>
                            </div>
                        ` : `
                            <div class="space-y-4 mb-6">
                                ${cart.map(item => `
                                    <div class="bg-white rounded-2xl p-4 shadow-md">
                                        <div class="flex gap-4">
                                            <img src="${item.image}" class="w-20 h-20 rounded-xl object-cover">
                                            <div class="flex-1">
                                                <h3 class="font-bold mb-1">${item.name}</h3>
                                                <p class="text-emerald-700 font-bold">${item.price} CAD</p>
                                                <p class="text-sm text-gray-500">ÿßŸÑŸÉŸÖŸäÿ©: ${item.quantity}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="bg-white rounded-2xl p-6 shadow-md">
                                <div class="flex justify-between text-lg mb-4">
                                    <span class="font-bold">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</span>
                                    <span class="font-bold text-emerald-700">${cartTotal.toFixed(2)} CAD</span>
                                </div>
                                <button onclick="alert('‚úÖ ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ®!')" 
                                    class="w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-4 rounded-xl font-bold text-lg">
                                    ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ∑ŸÑÿ®
                                </button>
                            </div>
                        `}
                    </div>
                `;
            }
            
            // Bottom Nav
            app.innerHTML += `
                <div class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-gradient-to-r from-emerald-800 to-teal-700 rounded-t-3xl px-8 py-5 shadow-2xl z-30">
                    <div class="flex items-center justify-around">
                        <button onclick="navigate('home')" class="flex flex-col items-center gap-1">
                            <div class="w-10 h-10 ${currentPage === 'home' ? 'bg-gradient-to-br from-pink-500 via-red-500 to-orange-500' : 'bg-white/10'} rounded-full flex items-center justify-center">
                                <i class="fas fa-home text-white"></i>
                            </div>
                            <span class="text-xs ${currentPage === 'home' ? 'text-white font-semibold' : 'text-white/60'}">ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</span>
                        </button>
                        
                        <button onclick="navigate('cart')" class="flex flex-col items-center gap-1 relative">
                            <div class="w-10 h-10 ${currentPage === 'cart' ? 'bg-gradient-to-br from-pink-500 via-red-500 to-orange-500' : 'bg-white/10'} rounded-full flex items-center justify-center">
                                <i class="fas fa-shopping-cart text-white"></i>
                            </div>
                            <span class="text-xs ${currentPage === 'cart' ? 'text-white font-semibold' : 'text-white/60'}">ÿßŸÑÿ≥ŸÑÿ©</span>
                            ${cartCount > 0 ? `
                                <div class="absolute -top-1 right-0 bg-yellow-400 text-emerald-900 w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold">
                                    ${cartCount}
                                </div>
                            ` : ''}
                        </button>
                        
                        <button class="flex flex-col items-center gap-1">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <span class="text-xs text-white/60">ÿßŸÑŸÖŸÑŸÅ</span>
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Auto-slide
        setInterval(() => {
            currentSlide = (currentSlide + 1) % slides.length;
            if (currentPage === 'home') render();
        }, 5000);
        
        // Init
        fetchProducts();
    </script>
</body>
</html>
